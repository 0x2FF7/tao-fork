import "../core/ops.tao"

#! Utilities for programming with strings.

type Str = [Char]

for B < Display member Str of Add B =
    => Output = Str
    => add = fn s, b => s ++ b:display

class Display =
    => display : Self -> Str

fn display A < Display : A -> Str = x => A.display(x)

member Nat of Display =
    => display = fn x => @display_int(--x)

member Int of Display =
    => display = fn x => @display_int(x)

member Char of Display =
    => display = fn c => [c]
