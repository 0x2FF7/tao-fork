import "lib/std/str.tao"

type IO A = @ -> (@, A)

$[lang(io_unit)]
fn io_unit A : A -> IO A = a, uni => (uni, a)

$[lang(io_bind)]
fn io_bind A, B : IO A -> (A -> IO B) -> IO B = a, f, uni =>
    let (uni, a) = a(uni) in
    f(a, uni)

# IO operations

fn print : Str -> IO () = s, uni =>
    let uni = @print(uni, s) in
    (uni, ())

fn input : IO Str = uni => @input(uni)
